---
title: "Final Project"
author: "Ryan Chiang"
date: "2024-05-07"
output: html_document
---

#they use seconds moving and bodily contact time to measure activity and affiliation
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
#install.packages("Matrix")
#install.packages("MCMCglmm")
library(Matrix)
#remove.packages("Matrix")
#install.packages("/Users/apple/Downloads/Matrix_1.2-7.1.tar", repos = "NULL", type = "source")
library(dplyr)
library(ggplot2)
library(rptR)
#library(lme4)
library(MCMCglmm)


```

```{r}
wasp <- read.csv("../final_project_STA101/wasp.csv")
```

### https://cran.r-project.org/web/packages/rptR/vignettes/rptR.html

### Repeatability is an important measurement when conducting and analyszing research. Finish doing the repeatability values later. 
```{r}
summary(wasp)
```
```{r}
activity1 <- rpt(seconds_moving ~ (1|Wasp.ID), grname = c("Wasp.ID"), data = wasp,
                 datatype = "Gaussian", nboot = 1000, ratio = TRUE)
```
```{r}
summary(activity1)
```

#when creating model they used poisson distribution.

```{r}
activity2 <- rpt(seconds_moving ~ Trial + weight + (1|Wasp.ID), grname = c("Wasp.ID", "Fixed", "Residual"), data = wasp,
                 datatype = "Gaussian", nboot = 1000, ratio = TRUE)
summary(activity2)
```
```{r}
activity3 <- rpt(seconds_moving ~ Trial + weight + (1|Wasp.ID), grname = c("Wasp.ID", "Fixed", "Residual"), data = wasp,
                 datatype = "Gaussian", nboot = 1000, ratio = FALSE)
```

```{r}
summary(activity3)
```




###trying to use lmer function
```{r}
library(lme4)
```

```{r}
lmer_fxn_trial <- lmer(seconds_moving ~ Trial + weight + (1|Wasp.ID), data = wasp)
```

```{r}
summary(lmer_fxn_trial)
```

### model selection

### article and important quote: https://stats.stackexchange.com/questions/231080/can-mcmcglmm-in-r-be-used-similarly-to-lmer
### "MCMCglmm and lmer are both functions that can be used for fitting linear mixed models. MCMCglmm takes a Bayesian approach where priors must be specified for fixed and random effects, enabling inference via Markov Chain Monte Carlo sampling, whereas lmer takes a likelihood approach within the frequentist paradigm."
### include other predictor variables???  potentially take out + Log_aggression + scale(seconds_moving) + anntenation... ask. 
```{r}
lmer_model_affilitation_full <- lmer(bodily_contact_time ~ Dummy_Color + Trial + weight + Log_aggression + scale(seconds_moving) + anntenation + (1|Wasp.ID), data = wasp)
lmer_model_affilitation_empty <- lmer(bodily_contact_time ~ (1|Wasp.ID), data = wasp)
```

```{r}
#install.packages("MPV")
#install.packages("leaps")
library(MPV)
library(leaps)
library(MASS)
#install.packages("lmerTest")
```

```{r}
lmerTest::step(lmer_model_affilitation_full)
```

```{r}

```

